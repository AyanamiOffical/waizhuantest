var d=(a,c,s)=>new Promise((u,o)=>{var i=e=>{try{n(s.next(e))}catch(r){o(r)}},l=e=>{try{n(s.throw(e))}catch(r){o(r)}},n=e=>e.done?u(e.value):Promise.resolve(e.value).then(i,l);n((s=s.apply(a,c)).next())});import{a as m}from"./oauthProvider-Bb_O-SwC.js";import{aq as h,d6 as f,b5 as _,d7 as k,d8 as $,d9 as g,ap as p,bp as A,aS as S}from"./bootstrap-B-VSIAtm.js";import{V as v,O as y,ak as C,_ as b}from"../jse/index-index-fT_vxJqM.js";const P=v({name:"OauthCallbackPage",components:{},setup(){const a=h(),c=y("");c.value+=`?state=${a.currentRoute.value.query.state}`,c.value+=`&code=${a.currentRoute.value.query.code}`;function s(u){return d(this,null,function*(){try{const o=yield m(u),{token:i}=o,l=f(),n=_();l.setAccessToken(i),yield n.fetchUserInfo();const[e,r]=yield Promise.all([n.fetchUserInfo(),k()]),t=e;l.setAccessCodes(r.data),yield a.push((t==null?void 0:t.homePath)||$),t!=null&&t.nickname&&g.success({description:`${p("authentication.loginSuccessDesc")}:${t==null?void 0:t.nickname}`,duration:3,message:p("authentication.loginSuccess")})}catch(o){A.error(p("sys.oauth.createAccount"),5),a.replace("/auth/login")}})}return s(c.value),{}}});function q(a,c,s,u,o,i){return b(),C("div")}const E=S(P,[["render",q]]);export{E as default};
