var s=(b,p,l)=>new Promise((c,m)=>{var g=n=>{try{o(l.next(n))}catch(d){m(d)}},y=n=>{try{o(l.throw(n))}catch(d){m(d)}},o=n=>n.done?c(n.value):Promise.resolve(n.value).then(g,y);o((l=l.apply(b,p)).next())});import{ap as a,cZ as S,c_ as V,bp as $,c$ as A,cf as D,aW as O,ch as T,d0 as M}from"./bootstrap-DXVvTFoS.js";import{u as I,_ as z}from"./TableAction.vue_vue_type_style_index_0_lang-CJNs7Aso.js";import{d as G}from"./schemas-UNsrvijF.js";import{V as N,O as x,k as Z,Z as j,_ as q,$ as u,x as h,U as r,a5 as _,a6 as v,ar as L}from"../jse/index-index-BpfZjsfB.js";import{u as P}from"./use-modal-DdHEjpwi.js";const Q=N({name:"DictionaryDetailModal",__name:"detail",setup(b,{expose:p}){const l=x(),c=x(!1),m={checkboxChange(e){c.value=e.$table.getCheckboxRecords().length>0},checkboxAll(e){c.value=e.$table.getCheckboxRecords().length>0}},g={checkboxConfig:{highlight:!0},toolbarConfig:{slots:{buttons:"toolbar-buttons"}},editConfig:{mode:"row",trigger:"click"},showOverflow:!0,columns:[...G.columns,{title:a("common.action"),fixed:"right",field:"action",slots:{default:({row:e})=>{var t,i,w,k;return Z(z,{actions:[{type:"link",icon:"clarity:note-edit-line",tooltip:a("common.edit"),onClick:n.bind(null,e),ifShow:!((t=o.grid)!=null&&t.isEditByRow(e))},{type:"link",icon:"lucide-lab:save",tooltip:a("common.saveText"),onClick:d.bind(null,e),ifShow:(i=o.grid)==null?void 0:i.isEditByRow(e)},{type:"link",icon:"material-symbols:cancel-outline",tooltip:a("common.cancelText"),onClick:n.bind(null,e),ifShow:(w=o.grid)==null?void 0:w.isEditByRow(e)},{icon:"ant-design:delete-outlined",type:"link",color:"error",tooltip:a("common.delete"),popConfirm:{title:a("common.deleteConfirm"),placement:"left",confirm:C.bind(null,[e.id])},ifShow:!((k=o.grid)!=null&&k.isEditByRow(e))}]})}}}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:t=>s(this,[t],function*({page:e}){return(yield M({page:e.currentPage,pageSize:e.pageSize,dictionaryId:l.value})).data})}}},[y,o]=I({gridOptions:g,gridEvents:m});function n(e){var t;(t=o.grid)==null||t.setEditRow(e)}function d(e){return s(this,null,function*(){var i;yield(i=o.grid)==null?void 0:i.clearEdit(),(e.id===0?yield S(e):yield V(e)).code===0&&($.success(a("common.successful")),yield o.reload())})}function R(){var t,i;const e={id:0,createdAt:Date.now(),status:1,dictionaryId:l.value};(t=o.grid)==null||t.insertAt(e,-1),(i=o.grid)==null||i.setEditRow(e)}function E(){T.confirm({title:a("common.deleteConfirm"),onOk(){return s(this,null,function*(){const t=o.grid.getCheckboxRecords().map(i=>i.id);C(t)})}})}function C(e){return s(this,null,function*(){(yield A({ids:e})).code===0&&(c.value=!1),yield o.reload()})}const[B,f]=P({fullscreenButton:!1,onCancel(){f.close()},onConfirm:()=>s(this,null,function*(){f.close()}),onOpenChange(e){var t;e&&(l.value=(t=f.getData())==null?void 0:t.id)},title:a("sys.dictionary.editDictionaryDetail")});return p(f),(e,t)=>(q(),j(r(B),{class:"h-1/2 w-1/2"},{default:u(()=>[h(r(y),null,{"toolbar-buttons":u(()=>[L(h(r(D),{danger:"",type:"primary",onClick:E},{default:u(()=>[_(v(r(a)("common.delete")),1)]),_:1},512),[[O,c.value]])]),"toolbar-tools":u(()=>[h(r(D),{type:"primary",onClick:R},{default:u(()=>[_(v(r(a)("sys.dictionary.addDictionaryDetail")),1)]),_:1})]),_:1})]),_:1}))}});export{Q as _};
