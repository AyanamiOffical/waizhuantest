var c=(l,u,a)=>new Promise((f,s)=>{var g=o=>{try{i(a.next(o))}catch(r){s(r)}},p=o=>{try{i(a.throw(o))}catch(r){s(r)}},i=o=>o.done?f(o.value):Promise.resolve(o.value).then(g,p);i((a=a.apply(l,u)).next())});import{b1 as k,ap as n,cf as y,aW as L,ch as B}from"./bootstrap-DXVvTFoS.js";import{u as S,_ as O}from"./TableAction.vue_vue_type_style_index_0_lang-CJNs7Aso.js";import{e as D,a as E}from"./schemas-vJlqn5f0.js";import{V,O as _,k as $,Z as M,_ as R,$ as h,x,U as d,ar as A,a5 as I,a6 as T}from"../jse/index-index-BpfZjsfB.js";import{u as q}from"./use-modal-DdHEjpwi.js";const z=l=>k.post("/sys-api/email_log/list",l),G=l=>k.post("/sys-api/email_log/delete",l),H=V({name:"EmailLogModal",__name:"email-log-modal",setup(l,{expose:u}){const a=_(),f={collapsed:!1,schema:[...E.schema],showCollapseButton:!1,submitOnEnter:!1},s=_(!1),g={checkboxChange(e){s.value=e.$table.getCheckboxRecords().length>0},checkboxAll(e){s.value=e.$table.getCheckboxRecords().length>0}},p={checkboxConfig:{highlight:!0},toolbarConfig:{slots:{buttons:"toolbar-buttons"}},editConfig:{mode:"row",trigger:"click"},showOverflow:!0,columns:[...D.columns,{title:n("common.action"),fixed:"right",field:"action",slots:{default:({row:e})=>{var t;return $(O,{actions:[{icon:"ant-design:delete-outlined",type:"link",color:"error",tooltip:n("common.delete"),popConfirm:{title:n("common.deleteConfirm"),placement:"left",confirm:b.bind(null,[e.id])},ifShow:!((t=o.grid)!=null&&t.isEditByRow(e))}]})}}}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(w,Q)=>c(this,[w,Q],function*({page:e},t){var C;return(yield z({page:e.currentPage,pageSize:e.pageSize,providerId:a.value,result:(C=t.result)!=null?C:0})).data})}}},[i,o]=S({gridOptions:p,formOptions:f,gridEvents:g});function r(){B.confirm({title:n("common.deleteConfirm"),onOk(){return c(this,null,function*(){const t=o.grid.getCheckboxRecords().map(w=>w.id);b(t)})}})}function b(e){return c(this,null,function*(){(yield G({ids:e})).code===0&&(s.value=!1),yield o.reload()})}const[v,m]=q({fullscreenButton:!1,onCancel(){m.close()},onConfirm:()=>c(this,null,function*(){m.close()}),onOpenChange(e){var t;e&&(a.value=(t=m.getData())==null?void 0:t.providerId)},title:n("mcms.emailLog.emailLogList")});return u(m),(e,t)=>(R(),M(d(v),{class:"h-2/3 w-1/2"},{default:h(()=>[x(d(i),null,{"toolbar-buttons":h(()=>[A(x(d(y),{danger:"",type:"primary",onClick:r},{default:h(()=>[I(T(d(n)("common.delete")),1)]),_:1},512),[[L,s.value]])]),_:1})]),_:1}))}});export{H as _};
