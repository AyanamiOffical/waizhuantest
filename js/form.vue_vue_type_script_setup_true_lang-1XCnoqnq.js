var f=(t,a,l)=>new Promise((i,d)=>{var u=r=>{try{n(l.next(r))}catch(o){d(o)}},c=r=>{try{n(l.throw(r))}catch(o){d(o)}},n=r=>r.done?i(r.value):Promise.resolve(r.value).then(u,c);n((l=l.apply(t,a)).next())});import{u as w}from"./form-Cza2qOOy.js";import{u as h,c as N}from"./storageProvider-CWdcsc5-.js";import{ap as e,cu as I,bp as D}from"./bootstrap-D7b_84de.js";import{k as b,V as S,O as p,Z as _,_ as C,$ as k,x as V,U as P}from"../jse/index-index-DpiZBZ8E.js";import x from"./index-m0N9Py6F.js";import{u as y}from"./use-modal-cKW3u1UH.js";const M={columns:[{type:"checkbox",width:60},{title:e("fms.storageProvider.name"),field:"name"},{title:e("fms.storageProvider.isDefault"),field:"isDefault",slots:{default:t=>{let a="";return a=t.row.isDefault?e("common.yes"):e("common.no"),b(I,{color:t.row.isDefault?"green":"red"},()=>a)}}},{title:e("common.status"),field:"state",slots:{default:t=>b(x,{checked:t.row.state,onClick:()=>{const a=!t.row.state;h({id:t.row.id,state:a}).then(()=>{t.row.state=a})}})}},{title:e("common.createTime"),field:"createdAt",formatter:"formatDateTime"}]},K={schema:[{fieldName:"name",label:e("fms.storageProvider.name"),component:"Input"}]},F={schema:[{fieldName:"id",label:"ID",component:"Input",dependencies:{show:!1,triggerFields:["id"]}},{fieldName:"name",label:e("fms.storageProvider.name"),component:"Input",help:e("fms.storageProvider.nameHelpMessage"),rules:"required"},{fieldName:"bucket",label:e("fms.storageProvider.bucket"),component:"Input",rules:"required"},{fieldName:"secretId",label:e("fms.storageProvider.secretId"),component:"Input",rules:"required"},{fieldName:"secretKey",label:e("fms.storageProvider.secretKey"),component:"Input",rules:"required"},{fieldName:"endpoint",label:e("fms.storageProvider.endpoint"),component:"Input",rules:"required"},{fieldName:"folder",label:e("fms.storageProvider.folder"),component:"Input"},{fieldName:"region",label:e("fms.storageProvider.region"),component:"Input"},{fieldName:"isDefault",label:e("fms.storageProvider.isDefault"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.on"),value:!0},{label:e("common.off"),value:!1}]}},{fieldName:"useCdn",label:e("fms.storageProvider.useCdn"),component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:e("common.on"),value:!0},{label:e("common.off"),value:!1}]}},{fieldName:"cdnUrl",label:e("fms.storageProvider.cdnUrl"),component:"Input"},{fieldName:"state",label:e("fms.storageProvider.state"),component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:e("common.on"),value:!0},{label:e("common.off"),value:!1}]}}]},$=S({name:"StorageProviderForm",__name:"form",setup(t,{expose:a}){const l=p(),i=p(!1),d=p();function u(s){return f(this,null,function*(){const m=i.value?yield h(s):yield N(s);m.code===0&&(D.success(m.msg),d.value.reload())})}const[c,n]=w({handleSubmit:u,schema:[...F.schema],showDefaultActions:!1,layout:"vertical"}),[r,o]=y({fullscreenButton:!1,onCancel(){o.close()},onConfirm:()=>f(this,null,function*(){(yield n.validate()).valid&&(yield n.submitForm(),o.close())}),onOpenChange(s){var m,v,g;i.value=(m=o.getData())==null?void 0:m.isUpdate,l.value=s?((v=o.getData())==null?void 0:v.record)||{}:{},d.value=s?(g=o.getData())==null?void 0:g.gridApi:null,s&&n.setValues(l.value),o.setState({title:i.value?e("fms.storageProvider.editStorageProvider"):e("fms.storageProvider.addStorageProvider")})}});return a(o),(s,m)=>(C(),_(P(r),null,{default:k(()=>[V(P(c))]),_:1}))}});export{$ as _,K as s,M as t};
