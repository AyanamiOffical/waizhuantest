var p=(n,l,s)=>new Promise((c,u)=>{var f=t=>{try{i(s.next(t))}catch(a){u(a)}},d=t=>{try{i(s.throw(t))}catch(a){u(a)}},i=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,d);i((s=s.apply(n,l)).next())});import{u as v}from"./form-ClcOlmjz.js";import{ap as e,cV as k,cW as w,bp as N}from"./bootstrap-C83mKH3e.js";import{s as m}from"./use-vben-form-DZ0hU62q.js";import{k as C,V as I,O as g,Z as _,_ as V,$ as F,x as S,U as h}from"../jse/index-index-GzxSC5Ev.js";import x from"./index-BPwIrRfc.js";import{u as A}from"./use-modal-C-YiCEuI.js";const G={columns:[{type:"checkbox",width:60},{title:e("sys.configuration.name"),field:"name"},{title:e("sys.configuration.key"),field:"key"},{title:e("sys.configuration.category"),field:"category"},{title:e("sys.configuration.remark"),field:"remark"},{title:e("common.status"),field:"state",slots:{default:n=>C(x,{checked:n.row.state,onClick:()=>{const l=!n.row.state;k({id:n.row.id,state:l}).then(()=>{n.row.state=l})}})}},{title:e("common.createTime"),field:"createdAt",formatter:"formatDateTime"}]},P={schema:[{fieldName:"name",label:e("sys.configuration.name"),component:"Input",rules:m().optional()},{fieldName:"key",label:e("sys.configuration.key"),component:"Input",rules:m().optional()},{fieldName:"category",label:e("sys.configuration.category"),component:"Input",rules:m().optional()}]},D={schema:[{fieldName:"id",label:"ID",component:"Input",dependencies:{show:!1,triggerFields:["id"]}},{fieldName:"name",label:e("sys.configuration.name"),component:"Input",rules:"required"},{fieldName:"key",label:e("sys.configuration.key"),component:"Input",rules:"required"},{fieldName:"value",label:e("sys.configuration.value"),component:"Input",rules:"required"},{fieldName:"category",label:e("sys.configuration.category"),component:"Input",rules:"required"},{fieldName:"remark",label:e("common.remark"),component:"Input",rules:m().optional()},{fieldName:"sort",label:e("common.sort"),component:"InputNumber",rules:"required",defaultValue:1},{fieldName:"state",label:e("common.status"),component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:e("common.on"),value:!0},{label:e("common.off"),value:!1}]}}]},W=I({name:"ConfigurationForm",__name:"form",setup(n,{expose:l}){const s=g(),c=g(!1),u=g();function f(o){return p(this,null,function*(){const r=c.value?yield k(o):yield w(o);r.code===0&&(N.success(r.msg),u.value.reload())})}const[d,i]=v({handleSubmit:f,schema:[...D.schema],showDefaultActions:!1,layout:"vertical"}),[t,a]=A({fullscreenButton:!1,onCancel(){a.close()},onConfirm:()=>p(this,null,function*(){(yield i.validate()).valid&&(yield i.submitForm(),a.close())}),onOpenChange(o){var r,y,b;c.value=(r=a.getData())==null?void 0:r.isUpdate,s.value=o?((y=a.getData())==null?void 0:y.record)||{}:{},u.value=o?(b=a.getData())==null?void 0:b.gridApi:null,o&&i.setValues(s.value),a.setState({title:c.value?e("sys.configuration.editConfiguration"):e("sys.configuration.addConfiguration")})}});return l(a),(o,r)=>(V(),_(h(t),null,{default:F(()=>[S(h(d))]),_:1}))}});export{W as _,P as s,G as t};
