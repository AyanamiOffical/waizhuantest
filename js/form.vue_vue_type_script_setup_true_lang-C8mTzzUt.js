var h=(a,d,n)=>new Promise((i,u)=>{var p=o=>{try{r(n.next(o))}catch(t){u(t)}},f=o=>{try{r(n.throw(o))}catch(t){u(t)}},r=o=>o.done?i(o.value):Promise.resolve(o.value).then(p,f);r((n=n.apply(a,d)).next())});import{u as I}from"./form-ClcOlmjz.js";import{b1 as c,ap as e,bp as _}from"./bootstrap-C83mKH3e.js";import{s}from"./use-vben-form-DZ0hU62q.js";import{V as g,O as v,Z as N,_ as U,$ as S,x as w,U as x}from"../jse/index-index-GzxSC5Ev.js";import{u as P}from"./use-modal-C-YiCEuI.js";const B=a=>c.post("/mms-api/oauth_provider/list",a),C=a=>c.post("/mms-api/oauth_provider/create",a),F=a=>c.post("/mms-api/oauth_provider/update",a),T=a=>c.post("/mms-api/oauth_provider/delete",a),M={columns:[{type:"checkbox",width:60},{title:e("common.name"),field:"name"},{title:e("sys.oauth.clientId"),field:"clientId"},{title:e("common.createTime"),field:"createdAt",formatter:"formatDateTime"}]},$={schema:[{fieldName:"name",label:e("common.name"),component:"Input",rules:s().max(30).optional()}]},A={schema:[{fieldName:"id",label:"ID",component:"Input",dependencies:{show:!1,triggerFields:["id"]}},{fieldName:"name",label:e("common.name"),component:"Input",rules:s().max(30)},{fieldName:"clientId",label:e("sys.oauth.clientId"),component:"Input",rules:s().max(80)},{fieldName:"clientSecret",label:e("sys.oauth.clientSecret"),component:"Input",rules:s().max(100)},{fieldName:"redirectUrl",label:e("sys.oauth.redirectURL"),component:"Input",rules:s().max(300)},{fieldName:"scopes",label:e("sys.oauth.scope"),component:"Input",rules:s().max(100)},{fieldName:"authUrl",label:e("sys.oauth.authURL"),component:"Input",rules:s().max(300)},{fieldName:"tokenUrl",label:e("sys.oauth.tokenURL"),component:"Input",rules:s().max(300)},{fieldName:"infoUrl",label:e("sys.oauth.infoURL"),component:"Input",rules:s().max(300)},{fieldName:"authStyle",label:e("sys.oauth.authStyle"),component:"Select",componentProps:{options:[{label:e("sys.oauth.params"),value:1},{label:e("sys.oauth.header"),value:2}],class:"w-full"}}]},q=g({name:"OauthProviderForm",__name:"form",setup(a,{expose:d}){const n=v(),i=v(!1),u=v();function p(l){return h(this,null,function*(){const m=i.value?yield F(l):yield C(l);m.code===0&&(_.success(m.msg),u.value.reload())})}const[f,r]=I({handleSubmit:p,schema:[...A.schema],showDefaultActions:!1,layout:"vertical"}),[o,t]=P({fullscreenButton:!1,onCancel(){t.close()},onConfirm:()=>h(this,null,function*(){(yield r.validate()).valid&&(yield r.submitForm(),t.close())}),onOpenChange(l){var m,b,y;i.value=(m=t.getData())==null?void 0:m.isUpdate,n.value=l?((b=t.getData())==null?void 0:b.record)||{}:{},u.value=l?(y=t.getData())==null?void 0:y.gridApi:null,l&&r.setValues(n.value),t.setState({title:i.value?e("sys.oauth.editProvider"):e("sys.oauth.addProvider")})}});return d(t),(l,m)=>(U(),N(x(o),null,{default:S(()=>[w(x(f))]),_:1}))}});export{q as _,T as d,B as g,$ as s,M as t};
