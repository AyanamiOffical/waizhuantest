var f=(s,m,l)=>new Promise((i,d)=>{var u=t=>{try{r(l.next(t))}catch(a){d(a)}},c=t=>{try{r(l.throw(t))}catch(a){d(a)}},r=t=>t.done?i(t.value):Promise.resolve(t.value).then(u,c);r((l=l.apply(s,m)).next())});import{u as D}from"./form-ZuhkTVCu.js";import{g,u as w,c as x}from"./department-aLx-h6vd.js";import{ap as e,bp as N}from"./bootstrap-_LeX4-bm.js";import{P as b}from"./common-Bjr5QI1d.js";import{s as o,n as F}from"./use-vben-form-BJ1BG10c.js";import{k as _,V as A,O as h,Z as S,_ as k,$ as T,x as V,U as v}from"../jse/index-index-CCysr0kX.js";import C from"./index-C_t4d1EK.js";import{u as P}from"./use-modal-OeyNsIFo.js";const H={columns:[{type:"checkbox",width:60},{title:e("sys.department.name"),field:"trans",treeNode:!0},{title:e("sys.department.leader"),field:"leader"},{title:e("common.status"),field:"status",slots:{default:s=>_(C,{checked:s.row.status===1,onClick:()=>{const m=s.row.status===1?2:1;w({id:s.row.id,status:m,parentId:s.row.parentId}).then(()=>{s.row.status=m})}})}},{title:e("common.createTime"),field:"createdAt",formatter:"formatDateTime"}]},Z={schema:[{fieldName:"name",label:e("sys.department.name"),component:"Input",rules:o().max(50).optional()},{fieldName:"leader",label:e("sys.department.leader"),component:"Input",rules:o().max(20).optional()}]},U={schema:[{fieldName:"id",label:"ID",component:"Input",dependencies:{show:!1,triggerFields:["id"]}},{fieldName:"name",label:e("sys.department.name"),component:"Input",rules:o().min(1).max(200)},{fieldName:"parentId",label:e("sys.department.parentId"),component:"ApiTreeSelect",rules:"required",componentProps:{api:g,params:{page:1,pageSize:1e3},resultField:"data.data",labelField:"trans",valueField:"id",defaultValue:{id:b.DEFAULT,parentId:-1,label:e("sys.department.firstLevelDepartment"),value:b.DEFAULT}},defaultValue:b.DEFAULT},{fieldName:"ancestors",label:e("sys.department.ancestors"),component:"Input",rules:o().max(200),componentProps:{disabled:!0},help:e("sys.department.ancestorsHelpMessage")},{fieldName:"leader",label:e("sys.department.leader"),component:"Input",rules:o().max(20)},{fieldName:"phone",label:e("sys.department.phone"),component:"Input",rules:o().max(18).optional()},{fieldName:"email",label:e("sys.department.email"),component:"Input",rules:o().max(70).optional()},{fieldName:"sort",label:e("sys.department.sort"),component:"InputNumber",rules:F().max(1e4),componentProps:{class:"w-full"}},{fieldName:"remark",label:e("common.remark"),component:"Input",rules:o().max(200).optional()},{fieldName:"status",label:e("sys.department.status"),component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:e("common.on"),value:1},{label:e("common.off"),value:0}]}}]},j=A({name:"DepartmentForm",__name:"form",setup(s,{expose:m}){const l=h(),i=h(!1),d=h();function u(n){return f(this,null,function*(){const p=i.value?yield w(n):yield x(n);p.code===0&&(N.success(p.msg),d.value.reload())})}const[c,r]=D({handleSubmit:u,schema:[...U.schema],showDefaultActions:!1,layout:"vertical"}),[t,a]=P({fullscreenButton:!1,onCancel(){a.close()},onConfirm:()=>f(this,null,function*(){(yield r.validate()).valid&&(yield r.submitForm(),a.close())}),onOpenChange(n){var p,y,I;i.value=(p=a.getData())==null?void 0:p.isUpdate,l.value=n?((y=a.getData())==null?void 0:y.record)||{}:{},d.value=n?(I=a.getData())==null?void 0:I.gridApi:null,n&&r.setValues(l.value),a.setState({title:i.value?e("sys.department.editDepartment"):e("sys.department.addDepartment")})}});return m(a),(n,p)=>(k(),S(v(t),null,{default:T(()=>[V(v(c))]),_:1}))}});export{j as _,Z as s,H as t};
