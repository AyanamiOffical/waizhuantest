var f=(n,s,t)=>new Promise((u,r)=>{var d=o=>{try{m(t.next(o))}catch(a){r(a)}},c=o=>{try{m(t.throw(o))}catch(a){r(a)}},m=o=>o.done?u(o.value):Promise.resolve(o.value).then(d,c);m((t=t.apply(n,s)).next())});import{u as N}from"./form-ClcOlmjz.js";import{ap as e,d2 as C,b3 as F,cu as T,d3 as _,d4 as P,bp as V}from"./bootstrap-C83mKH3e.js";import{P as y}from"./common-Bjr5QI1d.js";import{s as p,n as I}from"./use-vben-form-DZ0hU62q.js";import{k as b,V as x,O as v,Z as M,_ as B,$ as A,x as R,U as w}from"../jse/index-index-GzxSC5Ev.js";import{u as D}from"./use-modal-C-YiCEuI.js";const K={columns:[{title:e("sys.menu.menuName"),field:"trans",treeNode:!0},{title:e("sys.menu.icon"),field:"icon",slots:{default:n=>b(F,{icon:n.row.icon,width:20})},width:50},{title:e("sys.apis.serviceName"),field:"serviceName",width:120},{title:e("sys.menu.routePath"),field:"path"},{title:e("sys.menu.order"),field:"sort",width:90},{title:e("common.status"),field:"disabled",slots:{default:n=>{let s="";return s=n.row.disabled?e("common.off"):e("common.on"),b(T,{color:n.row.disabled?"red":"green"},()=>s)}},width:80},{title:e("sys.menu.isHidden"),field:"hideMenu",slots:{default:n=>{let s="";return s=n.row.hideMenu?e("common.yes"):e("common.no"),b(T,{color:n.row.hideMenu?"green":"red"},()=>s)}},width:80},{title:e("common.createTime"),field:"createdAt",formatter:"formatDateTime"}]},G={schema:[{fieldName:"id",label:"ID",component:"Input",dependencies:{show:!1,triggerFields:["id"]}},{fieldName:"menuType",label:e("sys.menu.type"),component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:e("sys.menu.directory"),value:0},{label:e("sys.menu.menu"),value:1},{label:e("sys.menu.element"),value:2}]},formItemClass:"col-span-2 items-baseline"},{fieldName:"name",label:e("sys.menu.menuName"),component:"Input",rules:p().max(50),formItemClass:"col-span-1",help:e("sys.menu.menuNameHelp")},{fieldName:"title",label:e("sys.menu.menuTitle"),component:"Input",rules:p().max(50),formItemClass:"col-span-1"},{fieldName:"parentId",label:e("sys.menu.menuParent"),component:"ApiTreeSelect",componentProps:{api:C,resultField:"data.data",labelField:"trans",valueField:"id",defaultValue:{id:y.DEFAULT,parentId:-1,label:e("sys.menu.rootMenu"),value:y.DEFAULT}},defaultValue:y.DEFAULT},{fieldName:"icon",label:e("sys.menu.icon"),component:"Input",help:e("sys.menu.iconHelp"),rules:"required"},{fieldName:"serviceName",label:e("sys.apis.serviceName"),component:"Input",formItemClass:"col-span-2 items-baseline",rules:p().max(50)},{fieldName:"path",label:e("sys.menu.routePath"),component:"Input",help:e("sys.menu.pathHelp"),formItemClass:"col-span-2 items-baseline",rules:p().regex(/^(\/?(:)?[\w-]+)*$/gm,e("common.wrongFormat")),dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType!==2}}},{fieldName:"component",label:e("sys.menu.component"),component:"Input",help:e("sys.menu.componentHelp"),formItemClass:"col-span-2 items-baseline",rules:p().regex(/^(\/[\w-]+)*(LAYOUT|IFrame)?$/gm,e("common.wrongFormat")),dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}},{fieldName:"redirect",label:e("sys.menu.redirectPath"),component:"Input",formItemClass:"col-span-2 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}},{fieldName:"frameSrc",label:e("sys.menu.frameSrc"),component:"Input",formItemClass:"col-span-2 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}},help:e("sys.menu.iframeHelp")},{fieldName:"realPath",label:e("sys.menu.realPath"),component:"Input",formItemClass:"col-span-2 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}},{fieldName:"sort",label:e("sys.menu.order"),component:"InputNumber",rules:I().max(1e4),defaultValue:1,formItemClass:"col-span-1"},{fieldName:"dynamicLevel",label:e("sys.menu.dynamicLevel"),component:"InputNumber",rules:I().max(30),defaultValue:20,formItemClass:"col-span-1",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType!==2}}},{fieldName:"permission",label:e("sys.menu.permission"),component:"Input",help:e("sys.menu.permissionHelp"),formItemClass:"col-span-2",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===2}}},{fieldName:"disabled",label:e("common.status"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.on"),value:!1},{label:e("common.off"),value:!0}]},formItemClass:"col-span-1 items-baseline"},{fieldName:"ignoreKeepAlive",label:e("sys.menu.isKeepAlive"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!1},{label:e("common.no"),value:!0}]},formItemClass:"col-span-1 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}},{fieldName:"hideMenu",label:e("sys.menu.isHidden"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!0},{label:e("common.no"),value:!1}]},formItemClass:"col-span-1 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType!==2}}},{fieldName:"hideBreadcrumb",label:e("sys.menu.isBreadcrumbShown"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!1},{label:e("common.no"),value:!0}]},formItemClass:"col-span-1 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}},{fieldName:"hideTab",label:e("sys.menu.hideTab"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!0},{label:e("common.no"),value:!1}]},formItemClass:"col-span-1 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}},{fieldName:"carryParam",label:e("sys.menu.carryParam"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!0},{label:e("common.no"),value:!1}]},formItemClass:"col-span-1 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}},{fieldName:"hideChildrenInMenu",label:e("sys.menu.hideChildrenInMenu"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!0},{label:e("common.no"),value:!1}]},formItemClass:"col-span-1 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType!==2}}},{fieldName:"affix",label:e("sys.menu.affix"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!0},{label:e("common.no"),value:!1}]},formItemClass:"col-span-1 items-baseline",dependencies:{triggerFields:["menuType"],show(n,s){return s.values.menuType===1}}}]},q=x({name:"MenuForm",__name:"form",setup(n,{expose:s}){const t=v(),u=v(!1),r=v();function d(l){return f(this,null,function*(){l.id=u.value?l.id:0,l.menuType===2&&(l.hideMenu=!0);const i=u.value?yield _(l):yield P(l);i.code===0&&(V.success(i.msg),r.value.reload())})}const[c,m]=N({handleSubmit:d,schema:[...G.schema],showDefaultActions:!1,layout:"vertical",commonConfig:{componentProps:{class:"w-full"}},wrapperClass:"grid-cols-2"}),[o,a]=D({fullscreenButton:!1,onCancel(){a.close()},onConfirm:()=>f(this,null,function*(){(yield m.validate()).valid&&(yield m.submitForm(),a.close())}),onOpenChange(l){var i,h,g;u.value=(i=a.getData())==null?void 0:i.isUpdate,t.value=l?((h=a.getData())==null?void 0:h.record)||{}:{},r.value=l?(g=a.getData())==null?void 0:g.gridApi:null,l&&m.setValues(t.value),a.setState({title:u.value?e("sys.menu.editMenu"):e("sys.menu.addMenu")})}});return s(a),(l,i)=>(B(),M(w(o),{class:"w-1/2"},{default:A(()=>[R(w(c))]),_:1}))}});export{q as _,K as t};
