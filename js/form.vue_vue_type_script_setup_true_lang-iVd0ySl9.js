var b=(a,p,i)=>new Promise((m,u)=>{var d=t=>{try{n(i.next(t))}catch(s){u(s)}},f=t=>{try{n(i.throw(t))}catch(s){u(s)}},n=t=>t.done?m(t.value):Promise.resolve(t.value).then(d,f);n((i=i.apply(a,p)).next())});import{u as g}from"./form-ClcOlmjz.js";import{b1 as c,ap as e,cu as N,bp as A}from"./bootstrap-C83mKH3e.js";import{s as o}from"./use-vben-form-DZ0hU62q.js";import{k as E,V as x,O as h,Z as P,_ as w,$ as C,x as S,U as T}from"../jse/index-index-GzxSC5Ev.js";import{u as _}from"./use-modal-C-YiCEuI.js";const L=a=>c.post("/sys-api/api/list",a),D=a=>c.post("/sys-api/api/create",a),I=a=>c.post("/sys-api/api/update",a),k=a=>c.post("/sys-api/api/delete",a),B={columns:[{type:"checkbox",width:60},{title:e("sys.apis.path"),field:"path"},{title:e("sys.apis.group"),field:"group"},{title:e("sys.apis.serviceName"),field:"serviceName",width:120},{title:e("sys.apis.description"),field:"trans"},{title:e("sys.apis.method"),field:"method"},{title:e("common.required"),field:"isRequired",width:80,slots:{default:a=>{let p="";return p=a.row.isRequired?e("common.yes"):e("common.no"),E(N,{color:a.row.isRequired?"green":"red"},()=>p)}}},{title:e("common.createTime"),field:"createdAt",formatter:"formatDateTime"}]},M={schema:[{fieldName:"path",label:e("sys.apis.path"),component:"Input",rules:o().max(200).optional()},{fieldName:"serviceName",label:e("sys.apis.serviceName"),component:"Input",rules:o().max(20).optional()},{fieldName:"group",label:e("sys.apis.group"),component:"Input",rules:o().max(80).optional()},{fieldName:"description",label:e("sys.apis.description"),component:"Input",rules:o().max(200).optional()},{fieldName:"method",label:e("sys.apis.method"),component:"Select",componentProps:{options:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"},{label:"PATCH",value:"PATCH"}]}}]},q={schema:[{fieldName:"id",label:"ID",component:"Input",dependencies:{show:!1,triggerFields:["id"]}},{fieldName:"path",label:e("sys.apis.path"),component:"Input",rules:o().max(200)},{fieldName:"serviceName",label:e("sys.apis.serviceName"),component:"Input",help:e("sys.apis.serviceNameHelpMessage"),rules:o().max(20)},{fieldName:"group",label:e("sys.apis.group"),component:"Input",rules:o().max(80)},{fieldName:"description",label:e("sys.apis.description"),component:"Input",rules:o().max(100)},{fieldName:"method",label:e("sys.apis.method"),component:"Select",componentProps:{options:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"},{label:"PATCH",value:"PATCH"}]}},{fieldName:"isRequired",label:e("common.required"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:e("common.yes"),value:!0},{label:e("common.no"),value:!1}]},help:e("sys.apis.isRequiredHelpMessage")}]},O=x({name:"ApiForm",__name:"form",setup(a,{expose:p}){const i=h(),m=h(!1),u=h();function d(l){return b(this,null,function*(){const r=m.value?yield I(l):yield D(l);r.code===0&&(A.success(r.msg),u.value.reload())})}const[f,n]=g({handleSubmit:d,schema:[...q.schema],showDefaultActions:!1,layout:"vertical"}),[t,s]=_({fullscreenButton:!1,onCancel(){s.close()},onConfirm:()=>b(this,null,function*(){(yield n.validate()).valid&&(yield n.submitForm(),s.close())}),onOpenChange(l){var r,v,y;m.value=(r=s.getData())==null?void 0:r.isUpdate,i.value=l?((v=s.getData())==null?void 0:v.record)||{}:{},u.value=l?(y=s.getData())==null?void 0:y.gridApi:null,l&&n.setValues(i.value),s.setState({title:m.value?e("sys.apis.editApi"):e("sys.apis.addApi")})}});return p(s),(l,r)=>(w(),P(T(t),null,{default:C(()=>[S(T(f))]),_:1}))}});export{O as _,k as d,L as g,M as s,B as t};
