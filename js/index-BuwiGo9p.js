var S=Object.defineProperty;var C=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var y=(a,e,t)=>e in a?S(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,x=(a,e)=>{for(var t in e||(e={}))V.call(e,t)&&y(a,t,e[t]);if(C)for(var t of C(e))O.call(e,t)&&y(a,t,e[t]);return a};var g=(a,e,t)=>new Promise((h,l)=>{var r=n=>{try{c(t.next(n))}catch(m){l(m)}},k=n=>{try{c(t.throw(n))}catch(m){l(m)}},c=n=>n.done?h(n.value):Promise.resolve(n.value).then(r,k);c((t=t.apply(a,e)).next())});import{ap as s,cf as M,aW as A,ch as F}from"./bootstrap-D7b_84de.js";import{r as D}from"./chunk-BZNENX2T-BoCj3v1U.js";import{_ as R,u as U}from"./TableAction.vue_vue_type_style_index_0_lang-CfMXA73L.js";import{t as z,a as E,s as G,g as N}from"./schemas-Ba4-1zdr.js";import{_ as j}from"./form.vue_vue_type_script_setup_true_lang-BNtUqvfM.js";import{_ as q}from"./task-log-modal.vue_vue_type_script_setup_true_lang-MPTY4Tvh.js";import{_ as I}from"./page.vue_vue_type_script_setup_true_lang-CorCHwzl.js";import{V as P,O as W,k as Z,Z as H,_ as J,$ as p,x as u,U as i,a5 as T,a6 as $,ar as K}from"../jse/index-index-DpiZBZ8E.js";import{u as v}from"./use-modal-cKW3u1UH.js";import"./index-CCviRy07.js";import"./form-Cza2qOOy.js";import"./use-vben-form-BpU-Ov5A.js";import"./render-content.vue_vue_type_script_lang-BnMYg2_n.js";import"./index-Bj5LX5qN.js";import"./index-m0N9Py6F.js";import"./index-C25cw5rK.js";const ho=P({name:"TaskManagement",__name:"index",setup(a){const[e,t]=v({connectedComponent:q}),[h,l]=v({connectedComponent:j}),r=W(!1),k={checkboxChange(o){r.value=o.$table.getCheckboxRecords().length>0},checkboxAll(o){r.value=o.$table.getCheckboxRecords().length>0}},c={collapsed:!1,schema:[...G.schema],showCollapseButton:!0,submitOnEnter:!1},n={checkboxConfig:{highlight:!0},toolbarConfig:{slots:{buttons:"toolbar-buttons"}},columns:[...z.columns,{title:s("common.action"),fixed:"right",field:"action",slots:{default:({row:o})=>Z(R,{actions:[{type:"link",icon:"clarity:note-edit-line",tooltip:s("common.edit"),onClick:b.bind(null,o)},{type:"link",icon:"ic:round-library-books",tooltip:s("sys.taskLog.taskLogList"),onClick:L.bind(null,o)},{icon:"ant-design:delete-outlined",type:"link",color:"error",tooltip:s("common.delete"),popConfirm:{title:s("common.deleteConfirm"),placement:"left",confirm:_.bind(null,[o.id])}}]})}}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(B,_o)=>g(this,[B,_o],function*({page:o},d){return(yield N(x({page:o.currentPage,pageSize:o.pageSize},d))).data})}}},[m,f]=U({formOptions:c,gridOptions:n,gridEvents:k});function b(o){D(o)?l.setData({record:o,isUpdate:!0,gridApi:f}):l.setData({record:null,isUpdate:!1,gridApi:f}),l.open()}function L(o){D(o)&&t.setData({taskId:o.id}),t.open()}function w(){F.confirm({title:s("common.deleteConfirm"),onOk(){return g(this,null,function*(){const d=f.grid.getCheckboxRecords().map(B=>B.id);_(d)})}})}function _(o){return g(this,null,function*(){(yield E({ids:o})).code===0&&(yield f.reload(),r.value=!1)})}return(o,d)=>(J(),H(i(I),{"auto-content-height":""},{default:p(()=>[u(i(h)),u(i(e)),u(i(m),null,{"toolbar-buttons":p(()=>[K(u(i(M),{danger:"",type:"primary",onClick:w},{default:p(()=>[T($(i(s)("common.delete")),1)]),_:1},512),[[A,r.value]])]),"toolbar-tools":p(()=>[u(i(M),{type:"primary",onClick:b},{default:p(()=>[T($(i(s)("sys.task.addTask")),1)]),_:1})]),_:1})]),_:1}))}});export{ho as default};
