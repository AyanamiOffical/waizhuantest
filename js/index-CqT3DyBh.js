var z=Object.defineProperty;var x=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var D=(i,o,t)=>o in i?z(i,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[o]=t,w=(i,o)=>{for(var t in o||(o={}))I.call(o,t)&&D(i,t,o[t]);if(x)for(var t of x(o))K.call(o,t)&&D(i,t,o[t]);return i};var d=(i,o,t)=>new Promise((h,g)=>{var b=s=>{try{c(t.next(s))}catch(p){g(p)}},u=s=>{try{c(t.throw(s))}catch(p){g(p)}},c=s=>s.done?h(s.value):Promise.resolve(s.value).then(b,u);c((t=t.apply(i,o)).next())});import{ap as n,bp as v,cf as M,aW as N,cH as T,ch as U}from"./bootstrap-B-VSIAtm.js";import{r as E}from"./chunk-BZNENX2T-BoCj3v1U.js";import{_ as G,u as j}from"./TableAction.vue_vue_type_style_index_0_lang-CJC400sX.js";import{_ as q,t as H,d as P,s as W,g as Y}from"./form.vue_vue_type_script_setup_true_lang-_6nOPqax.js";import{g as Z}from"./memberRank-BhbXOm5P.js";import{l as J}from"./token-DQ4ZCFTv.js";import{_ as R}from"./page.vue_vue_type_script_setup_true_lang-DTCuaPOc.js";import{C as Q}from"./index-BGYxKRlW.js";import{T as X}from"./index-D2Z_IEMQ.js";import{V as ee,O as k,Y as te,k as oe,Z as ae,_ as ne,$ as l,x as r,U as a,a5 as F,a6 as S,ar as ie}from"../jse/index-index-fT_vxJqM.js";import{u as le}from"./use-modal-BhR4F9RI.js";import{C as O,R as re}from"./index-C2AT83vn.js";import"./index-DrXurIMi.js";import"./form-CWWYCqXo.js";import"./use-vben-form-m2hWlrgt.js";import"./render-content.vue_vue_type_script_lang-CD9tW6pI.js";import"./index-D4GcylDq.js";import"./index-BMZQRmWB.js";import"./index-Bw1tMpvo.js";const Se=ee({name:"MemberManagement",__name:"index",setup(i){const o=k(),t=k();function h(){return d(this,null,function*(){const e=yield Z({page:1,pageSize:1e3});o.value=T(e.data.data,{labelField:"trans",valueField:"id",idKeyField:"id",childrenKeyField:"children",parentKeyField:"parentId"})})}function g(e){t.value=e[0],m.reload()}te(()=>{h()});const[b,u]=le({connectedComponent:q}),c=k(!1),s={checkboxChange(e){c.value=e.$table.getCheckboxRecords().length>0},checkboxAll(e){c.value=e.$table.getCheckboxRecords().length>0}},p={collapsed:!1,schema:[...W.schema],showCollapseButton:!0,submitOnEnter:!1},$={checkboxConfig:{highlight:!0},toolbarConfig:{slots:{buttons:"toolbar-buttons"}},columns:[...H.columns,{title:n("common.action"),fixed:"right",field:"action",slots:{default:({row:e})=>oe(G,{actions:[{label:"",type:"link",size:"small",tooltip:n("common.edit"),icon:"clarity:note-edit-line",onClick:C.bind(null,e)},{icon:"bx:log-out-circle",type:"link",color:"error",tooltip:n("sys.user.forceLoggingOut"),popConfirm:{title:n("sys.user.forceLoggingOut"),placement:"left",confirm:A.bind(null,e)}},{icon:"ant-design:delete-outlined",type:"link",color:"error",tooltip:n("common.delete"),popConfirm:{title:n("common.deleteConfirm"),placement:"left",confirm:y.bind(null,[e.id])}}]})}}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(L,_)=>d(this,[L,_],function*({page:e},f){return(yield Y(w({page:e.currentPage,pageSize:e.pageSize,rankId:t.value},f))).data})}}},[B,m]=j({formOptions:p,gridOptions:$,gridEvents:s});function C(e){E(e)?u.setData({record:e,isUpdate:!0,gridApi:m}):u.setData({record:null,isUpdate:!1,gridApi:m}),u.open()}function V(){U.confirm({title:n("common.deleteConfirm"),onOk(){return d(this,null,function*(){if(m.grid.getCheckboxRecords().some(_=>_.nickname==="admin")){v.warn(n("common.notAllowDeleteAdminData"));return}const L=m.grid.getCheckboxRecords().map(_=>_.id);y(L)})}})}function y(e){return d(this,null,function*(){(yield P({ids:e})).code===0&&(yield m.reload(),c.value=!1)})}function A(e){return d(this,null,function*(){(yield J(e.id)).code===0&&v.success(n("common.successful"))})}return(e,f)=>(ne(),ae(a(re),null,{default:l(()=>[r(a(O),{span:5},{default:l(()=>[r(a(R),{"auto-content-height":""},{default:l(()=>[r(a(Q),{title:a(n)("sys.member.rankId"),style:{height:"100%"}},{default:l(()=>[r(a(X),{"tree-data":o.value,"block-node":"",onSelect:g},null,8,["tree-data"])]),_:1},8,["title"])]),_:1})]),_:1}),r(a(O),{span:19},{default:l(()=>[r(a(R),{"auto-content-height":""},{default:l(()=>[r(a(b)),r(a(B),null,{"toolbar-buttons":l(()=>[ie(r(a(M),{danger:"",type:"primary",onClick:V},{default:l(()=>[F(S(a(n)("common.delete")),1)]),_:1},512),[[N,c.value]])]),"toolbar-tools":l(()=>[r(a(M),{type:"primary",onClick:C},{default:l(()=>[F(S(a(n)("sys.member.addMember")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{Se as default};
