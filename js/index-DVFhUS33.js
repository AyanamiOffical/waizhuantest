var O=Object.defineProperty;var x=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var M=(n,t,o)=>t in n?O(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,A=(n,t)=>{for(var o in t||(t={}))F.call(t,o)&&M(n,o,t[o]);if(x)for(var o of x(t))U.call(t,o)&&M(n,o,t[o]);return n};var h=(n,t,o)=>new Promise((g,c)=>{var _=a=>{try{l(o.next(a))}catch(p){c(p)}},m=a=>{try{l(o.throw(a))}catch(p){c(p)}},l=a=>a.done?g(a.value):Promise.resolve(a.value).then(_,m);l((o=o.apply(n,t)).next())});import{ap as i,cf as D,aW as E,ch as G}from"./bootstrap-B-VSIAtm.js";import{r as b}from"./chunk-BZNENX2T-BoCj3v1U.js";import{_ as I,u as N}from"./TableAction.vue_vue_type_style_index_0_lang-CJC400sX.js";import{d as j,g as q}from"./role-mYFWjIOr.js";import{_ as L}from"./api-authority.vue_vue_type_script_setup_true_lang-B7WZJxYa.js";import{_ as P}from"./menu-authority.vue_vue_type_script_setup_true_lang-BIEUWx_w.js";import{_ as T,t as W,s as Z}from"./form.vue_vue_type_script_setup_true_lang-ewAzdHIM.js";import{_ as H}from"./page.vue_vue_type_script_setup_true_lang-DTCuaPOc.js";import{V as J,O as K,k as Q,Z as X,_ as Y,$ as u,x as r,U as s,a5 as $,a6 as v,ar as ee}from"../jse/index-index-fT_vxJqM.js";import{u as C}from"./use-modal-BhR4F9RI.js";import"./index-DrXurIMi.js";import"./form-CWWYCqXo.js";import"./use-vben-form-m2hWlrgt.js";import"./render-content.vue_vue_type_script_lang-CD9tW6pI.js";import"./index-D4GcylDq.js";import"./index-BMZQRmWB.js";import"./index-Bw1tMpvo.js";import"./authority-7Q1vNRLx.js";import"./index-D2Z_IEMQ.js";const xe=J({name:"RoleManagement",__name:"index",setup(n){const[t,o]=C({connectedComponent:L}),[g,c]=C({connectedComponent:P}),[_,m]=C({connectedComponent:T}),l=K(!1),a={checkboxChange(e){l.value=e.$table.getCheckboxRecords().length>0},checkboxAll(e){l.value=e.$table.getCheckboxRecords().length>0}},p={collapsed:!1,schema:[...Z.schema],showCollapseButton:!0,submitOnEnter:!1},R={checkboxConfig:{highlight:!0},toolbarConfig:{slots:{buttons:"toolbar-buttons"}},columns:[...W.columns,{title:i("common.action"),fixed:"right",field:"action",slots:{default:({row:e})=>Q(I,{actions:[{type:"link",size:"small",icon:"clarity:note-edit-line",tooltip:i("common.edit"),onClick:y.bind(null,e)},{type:"link",size:"small",icon:"ep:menu",tooltip:i("sys.authority.menuAuthority"),onClick:B.bind(null,e)},{type:"link",size:"small",icon:"carbon:network-interface",tooltip:i("sys.authority.apiAuthority"),onClick:S.bind(null,e)},{icon:"ant-design:delete-outlined",type:"link",color:"error",tooltip:i("common.delete"),popConfirm:{title:i("common.deleteConfirm"),placement:"left",confirm:k.bind(null,[e.id])}}]})}}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(z,De)=>h(this,[z,De],function*({page:e},d){return(yield q(A({page:e.currentPage,pageSize:e.pageSize},d))).data})}}},[w,f]=N({formOptions:p,gridOptions:R,gridEvents:a});function y(e){b(e)?m.setData({record:e,isUpdate:!0,gridApi:f}):m.setData({record:null,isUpdate:!1,gridApi:f}),m.open()}function B(e){b(e)&&c.setData({roleId:e.id}),c.open()}function S(e){b(e)&&o.setData({roleId:e.id}),o.open()}function V(){G.confirm({title:i("common.deleteConfirm"),onOk(){return h(this,null,function*(){const d=f.grid.getCheckboxRecords().map(z=>z.id);k(d)})}})}function k(e){return h(this,null,function*(){(yield j({ids:e})).code===0&&(yield f.reload(),l.value=!1)})}return(e,d)=>(Y(),X(s(H),{"auto-content-height":""},{default:u(()=>[r(s(g)),r(s(_)),r(s(t)),r(s(w),null,{"toolbar-buttons":u(()=>[ee(r(s(D),{danger:"",type:"primary",onClick:V},{default:u(()=>[$(v(s(i)("common.delete")),1)]),_:1},512),[[E,l.value]])]),"toolbar-tools":u(()=>[r(s(D),{type:"primary",onClick:y},{default:u(()=>[$(v(s(i)("sys.role.addRole")),1)]),_:1})]),_:1})]),_:1}))}});export{xe as default};
