var p=(m,c,d)=>new Promise((n,o)=>{var l=t=>{try{s(d.next(t))}catch(a){o(a)}},i=t=>{try{s(d.throw(t))}catch(a){o(a)}},s=t=>t.done?n(t.value):Promise.resolve(t.value).then(l,i);s((d=d.apply(m,c)).next())});import{ap as y,bp as v,d2 as k,cH as x}from"./bootstrap-_LeX4-bm.js";import{b as M,d as _}from"./authority-BVcgWOJs.js";import{V as K,O as r,Z as b,_ as I,$ as g,x as A,U as f}from"../jse/index-index-CCysr0kX.js";import{u as C}from"./use-modal-OeyNsIFo.js";import{T as D}from"./index-Bt7lqI7L.js";const $=K({name:"MenuAuthorityModal",__name:"menu-authority",setup(m,{expose:c}){const d=r([]),n=r(),o=r(),l=r(),[i,s]=C({fullscreenButton:!1,onCancel(){s.close()},onConfirm:()=>p(this,null,function*(){n.value.checked!==void 0&&(yield M({roleId:l.value,menuIds:n.value.checked})).code===0&&v.success(y("common.successful")),s.close()}),onOpenChange(a){var e;l.value=a?((e=s.getData())==null?void 0:e.roleId)||{}:{},a&&t(l.value)},title:y("sys.authority.menuAuthority")});function t(a){return p(this,null,function*(){try{d.value=[];const e=yield k();d.value=x(e.data.data,{idKeyField:"id",parentKeyField:"parentId",childrenKeyField:"children",valueField:"id",labelField:"trans"});const u=yield _({id:a});n.value=u.data.menuIds,o.value=e.data.data.map((h,F,w)=>h.id)}catch(e){}})}return c(s),(a,e)=>(I(),b(f(i),null,{default:g(()=>[A(f(D),{"checked-keys":n.value,"onUpdate:checkedKeys":e[0]||(e[0]=u=>n.value=u),"expanded-keys":o.value,"onUpdate:expandedKeys":e[1]||(e[1]=u=>o.value=u),"tree-data":d.value,"check-strictly":"",checkable:"","default-expand-all":""},null,8,["checked-keys","expanded-keys","tree-data"])]),_:1}))}});export{$ as _};
