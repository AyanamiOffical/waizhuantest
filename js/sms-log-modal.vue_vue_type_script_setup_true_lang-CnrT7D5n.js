var c=(n,u,s)=>new Promise((f,a)=>{var g=o=>{try{r(s.next(o))}catch(i){a(i)}},p=o=>{try{r(s.throw(o))}catch(i){a(i)}},r=o=>o.done?f(o.value):Promise.resolve(o.value).then(g,p);r((s=s.apply(n,u)).next())});import{b1 as k,ap as l,cf as y,aW as S,ch as L}from"./bootstrap-DXVvTFoS.js";import{u as B,_ as O}from"./TableAction.vue_vue_type_style_index_0_lang-CJNs7Aso.js";import{b as D,c as V}from"./schemas-BJEIvuGc.js";import{V as $,O as _,k as M,Z as R,_ as A,$ as h,x,U as d,ar as E,a5 as I,a6 as T}from"../jse/index-index-BpfZjsfB.js";import{u as q}from"./use-modal-DdHEjpwi.js";const z=n=>k.post("/sys-api/sms_log/list",n),G=n=>k.post("/sys-api/sms_log/delete",n),H=$({name:"SmsLogModal",__name:"sms-log-modal",setup(n,{expose:u}){const s=_(),f={collapsed:!1,schema:[...V.schema],showCollapseButton:!1,submitOnEnter:!1},a=_(!1),g={checkboxChange(e){a.value=e.$table.getCheckboxRecords().length>0},checkboxAll(e){a.value=e.$table.getCheckboxRecords().length>0}},p={checkboxConfig:{highlight:!0},toolbarConfig:{slots:{buttons:"toolbar-buttons"}},editConfig:{mode:"row",trigger:"click"},showOverflow:!0,columns:[...D.columns,{title:l("common.action"),fixed:"right",field:"action",slots:{default:({row:e})=>{var t;return M(O,{actions:[{icon:"ant-design:delete-outlined",type:"link",color:"error",tooltip:l("common.delete"),popConfirm:{title:l("common.deleteConfirm"),placement:"left",confirm:b.bind(null,[e.id])},ifShow:!((t=o.grid)!=null&&t.isEditByRow(e))}]})}}}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(w,Q)=>c(this,[w,Q],function*({page:e},t){var C;return(yield z({page:e.currentPage,pageSize:e.pageSize,providerId:s.value,result:(C=t.result)!=null?C:0})).data})}}},[r,o]=B({gridOptions:p,formOptions:f,gridEvents:g});function i(){L.confirm({title:l("common.deleteConfirm"),onOk(){return c(this,null,function*(){const t=o.grid.getCheckboxRecords().map(w=>w.id);b(t)})}})}function b(e){return c(this,null,function*(){(yield G({ids:e})).code===0&&(a.value=!1),yield o.reload()})}const[v,m]=q({fullscreenButton:!1,onCancel(){m.close()},onConfirm:()=>c(this,null,function*(){m.close()}),onOpenChange(e){var t;e&&(s.value=(t=m.getData())==null?void 0:t.providerId)},title:l("mcms.smsLog.smsLogList")});return u(m),(e,t)=>(A(),R(d(v),{class:"h-2/3 w-1/2"},{default:h(()=>[x(d(r),null,{"toolbar-buttons":h(()=>[E(x(d(y),{danger:"",type:"primary",onClick:i},{default:h(()=>[I(T(d(l)("common.delete")),1)]),_:1},512),[[S,a.value]])]),_:1})]),_:1}))}});export{H as _};
